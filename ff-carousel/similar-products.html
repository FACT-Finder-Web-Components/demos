<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ff-carousel + similar-products demo</title>

    <script>
        var Polymer = Polymer || {};
        Polymer.dom = 'shady';
        document.addEventListener("ffReady", function (evt) {
            factfinder.communication.sp[btoa("Search.ff")] = true;
            factfinder.communication.sp[btoa("Tracking.ff")] = true;

            factfinder.communication.ResultDispatcher.subscribe("result", function (result) {
                var similarProductsElement = document.querySelector("ff-similar-products");
                var example = document.querySelector("#exampleSelection");
                if (result.resultStatus === "nothingFound") {
                    //reset recommendation
                    similarProductsElement.recordId = "";
                } else {
                    var record = result.records[0];
                    similarProductsElement.recordId = record.id;
                    example.recordData = record;
                }

            });
        });
    </script>
    <script src="../bower_components/webcomponentsjs/webcomponents-lite.min.js"></script>
    <link rel="import"
          href="../bower_components/ff-web-components/dist/elements.build_with_dependencies.html">
</head>
<body>

<style is="custom-style">

    ff-similar-products {
        border: 2px solid orangered;
        margin-bottom: 15px;
    }

    .similarProductsHeader {
        background-color: orangered;
        color: white;
        width: 150px;
        padding: 10px;
        font-weight: bold;
    }

    ff-record {
        width: 215px;
        min-height: 150px;
    }

    ff-record > img {
        text-align: center;
        width: 150px;
        height: 150px;
    }

    ff-carousel {
        --ff-carousel-legend: {
            margin-top: 20px;
        };
        --ff-carousel-plane: {
            padding-top: 10px;
        };
        position: relative;
    }

    ff-record-list:hover [data-next], ff-record-list:hover [data-prev] {
        opacity: 0.7;
    }

    [data-prev], [data-next] {
        position: absolute;
        height: 100px;
        width: 100px;
        z-index: 2;
        opacity: 0;
        cursor: pointer;
    }

    [data-next] {
        top: 90px;
        right: -10px;
    }

    [data-prev] {
        top: 90px;
        left: -10px;
    }

    .price {
        text-align: center;
        color: orange;
    }

    .manufacturer {
        text-align: center;
    }

    .title {
        height: 40px;
    }
</style>

<ff-communication url="http://web-components.fact-finder.de/FACT-Finder-7.2"
                  version="7.2"
                  channel="bergfreunde-co-uk"
                  ignore-page="true"
                  search-immediate>
</ff-communication>

<h3>Search</h3>
<p>
    Just search for some items. The first product in the search result will be used as base suggest similar products.
</p>
<input is="ff-searchbox"/>
<button is="ff-searchbutton">Search</button>

<h3>Selected Record</h3>
<ff-record id="exampleSelection">
    <a href="https://www.bergfreunde.de{{record.Deeplink}}">
        <img data-image={{record.ImageName}}
             data-image-onerror="../img_not_found.gif"
             data-redirect="https://www.bergfreunde.de{{record.Deeplink}}"
             data-redirect-target="_self">
    </a>

    <div>
        <div class="manufacturer"><b>{{record.Manufacturer}}</b></div>
        <div class="title">
            <a data-track href="https://www.bergfreunde.de{{record.Deeplink}}">
                {{record.Title}}
            </a>
        </div>
        <div class="price"> € <strong>{{record.Price}}</strong></div>
    </div>
</ff-record>

<h3>Similar Products for Selected Record</h3>
<ff-similar-products max-results="4" unresolved>
    <div class="similarProductsHeader">
        Similar Products
    </div>
    <ff-record-list id="test-list">
        <ff-carousel infinite="true" show-legend="true" per-slide="3">
            <img src="arrow-left.png" data-prev>"prev"</img>
            <img src="arrow-right.png" data-next>"next"</img>
            <ff-record slot="items">
                <a href="https://www.bergfreunde.de{{record.Deeplink}}">
                    <img data-image={{record.ImageName}}
                         data-image-onerror="../img_not_found.gif"
                         data-redirect="https://www.bergfreunde.de{{record.Deeplink}}"
                         data-redirect-target="_self">
                </a>

                <div>
                    <div class="manufacturer"><b>{{record.Manufacturer}}</b></div>
                    <div class="title">
                        <a data-track href="https://www.bergfreunde.de{{record.Deeplink}}">
                            {{record.Title}}
                        </a>
                    </div>
                    <div class="price"> € <strong>{{record.Price}}</strong></div>
                </div>
            </ff-record>
        </ff-carousel>
    </ff-record-list>
</ff-similar-products>

</body>
</html>